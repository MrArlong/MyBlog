<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <title>查看</title>
  <link rel="stylesheet" href="../layui/css/layui.css" />
  <link rel="stylesheet" href="../css/article/lokeBlog.css">
</head>
<script src="../vue/vue.js"></script>
<script src="../layui/layui.all.js"></script>

<body>
  <div class="layui_top">
    <div class="layui_top_01">
      <ul class="">
        <li class="layui_top_02"><a href="/">首页</a></li>
        <li class="layui_top_02 "><a href="">博客</a></li>
        <li class="layui_top_02"><a href="">模块</a></li>
        <li class="layui_top_02"><a href="">模块</a></li>
      </ul>
        <div class="layui-input-block layui_top_03">
            <button class="layui-btn layui-btn-normal layui_top_05 update">
                更新
            </button>
            <button class="layui-btn layui-btn-normal layui_top_05 delete">
                删除
            </button>
        </div>
    </div>
    <div class="loke_top">
      <div class="loke_top_01">
          <div class="loke_top_bt">
              <b class="loke_top_bt_01 bt"></b>
          </div>
            <!--时间 -->
             <!--标签-->
          <div class="loke_top_sjorbq">
              <span class="loke_top_sj "><i class="layui-icon layui-icon-date sj"> </i></span>
              <span class="loke_top_bq "><i class="layui-icon layui-icon-date bq"> </i></span>
          </div>
          <hr>
        <!--正文-->
          <div class="loke_zw zw">

          </div>
        <!--底部的空间撑起来-->
          <div class="footer">

          </div>
      </div>
    </div>

      <div class="footer_01">
          <footer>
              <div>
                  备案信息：<a href="//www.beian.miit.gov.cn/">豫ICP备19034999号</a>
              </div>
          </footer>
      </div>
  </div>
  <script>
    layui.use(['layer', 'form', 'jquery', 'element'], function () {
      var layer = layui.layer,
        $ = layui.$,
        form = layui.form, //form表单
        upload = layui.upload, //图片文件上传
        element = layui.element,
        carousel = layui.carousel
        //接收传值
        function getQueryString(name) {
            var reg = new RegExp('(^|&)' + name + '=([^&]*)(&|$)', 'i');
            var r = window.location.search.substr(1).match(reg);
            if (r != null) {
                return unescape(r[2]);
            }
            return null;
        }
        var ind = getQueryString("myblogArticleId")
        $.ajax({
            url: '/index/queryArticle?myblogArticleId='+ ind,
            type: 'post',
            dataType: 'json',
            success: function (res) {
                $(".bt").html(res.data[0].myblogArticleTitle);//标题
                $(".sj").html(res.data[0].myblogArticleCreationtime);//时间
                $(".bq").html(res.data[0].myblogLabelName);//标签
                $(".zw").html(res.data[0].myblogArticleContents);//正文
            },
            error: function () {
                layer.msg("网络异常");
            }
        });
      //浏览次数
        $.ajax({
            url: '/index/queryArticle?myblogArticleId='+ ind,
            type: 'post',
            dataType: 'json',
            success: function (res) {
                $(".bt").html(res.data[0].myblogArticleTitle);//标题
                $(".sj").html(res.data[0].myblogArticleCreationtime);//时间
                $(".bq").html(res.data[0].myblogLabelName);//标签
                $(".zw").html(res.data[0].myblogArticleContents);//时间
            },
            error: function () {
                layer.msg("网络异常");
            }
        });
      //更新文章
        $('body').on('click', '.update', function (res) {
            window.location.href = 'article.html?myblogArticleId='+ind
        })
      //删除文章
        $('body').on('click', '.delete', function (res) {
            $.ajax({
                url: '/index/deleteArticle',
                type: 'post',
                dataType: 'json',
                data: {
                    myblogArticleId:ind,
                },
                success: function (res) {
                    layer.msg(res.msg,{icon:5,time:1500},function () {
                        if(res.msg==='删除成功'){
                            window.location.href = '/'
                        }
                        }
                    );
                },
                error: function () {
                    layer.msg("网络异常");
                }
            });
        })


    })
  </script>
</body>

</html>